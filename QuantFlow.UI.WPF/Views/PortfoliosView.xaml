<UserControl x:Class="QuantFlow.UI.WPF.Views.PortfoliosView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d" 
             d:DesignHeight="800" d:DesignWidth="1200"
             Background="{DynamicResource BackgroundColor}">
    <ScrollViewer VerticalScrollBarVisibility="Auto" 
                  HorizontalScrollBarVisibility="Disabled"
                  Padding="40,20,40,40">
        <StackPanel>
            <!-- Page Header -->
            <Grid Margin="0,0,0,32">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0"
                           Text="My Portfolios" 
                           FontSize="28" 
                           FontWeight="Bold" 
                           Foreground="{DynamicResource TextPrimaryColor}"
                           FontFamily="Segoe UI"
                           VerticalAlignment="Center"/>

                <Button Grid.Column="1"
                        Content="+ Create Portfolio"
                        Style="{StaticResource PrimaryButton}"
                        Command="{Binding CreatePortfolioCommand}"
                        Height="44"
                        Padding="24,0"/>
            </Grid>

            <!-- Portfolio Cards -->
            <ItemsControl ItemsSource="{Binding Portfolios}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border Background="{DynamicResource SurfaceColor}"
                                BorderBrush="{DynamicResource BorderColor}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Padding="24"
                                Margin="0,0,0,20">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- Portfolio Info -->
                                <StackPanel Grid.Column="0">
                                    <!-- Name and Mode Badge -->
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                        <TextBlock Text="{Binding Name}" 
                                                   FontSize="20" 
                                                   FontWeight="SemiBold" 
                                                   Foreground="{DynamicResource TextPrimaryColor}"
                                                   FontFamily="Segoe UI"
                                                   VerticalAlignment="Center"
                                                   Margin="0,0,12,0"/>

                                        <Border Background="{Binding ModeBadgeColor}"
                                                CornerRadius="4"
                                                Padding="8,4"
                                                Margin="0,0,8,0">
                                            <TextBlock Text="{Binding ModeText}" 
                                                       FontSize="11" 
                                                       FontWeight="SemiBold" 
                                                       Foreground="White"
                                                       FontFamily="Segoe UI"/>
                                        </Border>

                                        <Border Background="{Binding StatusBadgeColor}"
                                                CornerRadius="4"
                                                Padding="8,4">
                                            <TextBlock Text="{Binding StatusText}" 
                                                       FontSize="11" 
                                                       FontWeight="SemiBold" 
                                                       Foreground="White"
                                                       FontFamily="Segoe UI"/>
                                        </Border>
                                    </StackPanel>

                                    <!-- Description -->
                                    <TextBlock Text="{Binding Description}" 
                                               FontSize="13" 
                                               Foreground="{DynamicResource TextSecondaryColor}"
                                               FontFamily="Segoe UI"
                                               TextWrapping="Wrap"
                                               Margin="0,0,0,16"
                                               Visibility="{Binding HasDescription, Converter={StaticResource BoolToVisibilityConverter}}"/>

                                    <!-- Stats Grid -->
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="32"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="32"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="32"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Initial Balance -->
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="Initial Balance" 
                                                       FontSize="11" 
                                                       Foreground="{DynamicResource TextSecondaryColor}"
                                                       FontFamily="Segoe UI"
                                                       Margin="0,0,0,4"/>
                                            <TextBlock Text="{Binding InitialBalanceFormatted}" 
                                                       FontSize="14" 
                                                       FontWeight="SemiBold" 
                                                       Foreground="{DynamicResource TextPrimaryColor}"
                                                       FontFamily="Segoe UI"/>
                                        </StackPanel>

                                        <!-- Current Balance -->
                                        <StackPanel Grid.Column="2">
                                            <TextBlock Text="Current Balance" 
                                                       FontSize="11" 
                                                       Foreground="{DynamicResource TextSecondaryColor}"
                                                       FontFamily="Segoe UI"
                                                       Margin="0,0,0,4"/>
                                            <TextBlock Text="{Binding CurrentBalanceFormatted}" 
                                                       FontSize="14" 
                                                       FontWeight="SemiBold" 
                                                       Foreground="{DynamicResource TextPrimaryColor}"
                                                       FontFamily="Segoe UI"/>
                                        </StackPanel>

                                        <!-- Exchange -->
                                        <StackPanel Grid.Column="4" 
                                                    Visibility="{Binding HasExchange, Converter={StaticResource BoolToVisibilityConverter}}">
                                            <TextBlock Text="Exchange" 
                                                       FontSize="11" 
                                                       Foreground="{DynamicResource TextSecondaryColor}"
                                                       FontFamily="Segoe UI"
                                                       Margin="0,0,0,4"/>
                                            <TextBlock Text="{Binding ExchangeName}" 
                                                       FontSize="14" 
                                                       FontWeight="SemiBold" 
                                                       Foreground="{DynamicResource TextPrimaryColor}"
                                                       FontFamily="Segoe UI"/>
                                        </StackPanel>

                                        <!-- Created Date -->
                                        <StackPanel Grid.Column="6">
                                            <TextBlock Text="Created" 
                                                       FontSize="11" 
                                                       Foreground="{DynamicResource TextSecondaryColor}"
                                                       FontFamily="Segoe UI"
                                                       Margin="0,0,0,4"/>
                                            <TextBlock Text="{Binding CreatedAtFormatted}" 
                                                       FontSize="14" 
                                                       FontWeight="SemiBold" 
                                                       Foreground="{DynamicResource TextPrimaryColor}"
                                                       FontFamily="Segoe UI"/>
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>
                                
                                <!-- Action Buttons -->
                                <StackPanel Grid.Column="1" 
                                            Orientation="Horizontal" 
                                            VerticalAlignment="Top"
                                            Margin="16,0,0,0">
                                    <Button Content="View Details"
                                            Style="{StaticResource PrimaryButton}"
                                            Command="{Binding DataContext.ViewPortfolioDetailsCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                            CommandParameter="{Binding}"
                                            Width="130"
                                            Height="36"
                                            Margin="0,0,8,0"/>

                                    <Button Content="Edit"
                                            Style="{StaticResource SecondaryButton}"
                                            Command="{Binding DataContext.EditPortfolioCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                            CommandParameter="{Binding}"
                                            Width="80"
                                            Height="36"
                                            Margin="0,0,8,0"/>

                                    <Button Content="Delete"
                                            Style="{StaticResource SecondaryButton}"
                                            Command="{Binding DataContext.DeletePortfolioCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                            CommandParameter="{Binding}"
                                            Width="80"
                                            Height="36"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>

            <!-- Empty State -->
            <Border Background="{DynamicResource SurfaceColor}"
                    BorderBrush="{DynamicResource BorderColor}"
                    BorderThickness="1"
                    CornerRadius="12"
                    Padding="60"
                    Visibility="{Binding HasNoPortfolios, Converter={StaticResource BoolToVisibilityConverter}}">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="📊" 
                               FontSize="64" 
                               HorizontalAlignment="Center"
                               Margin="0,0,0,16"/>
                    <TextBlock Text="No portfolios yet" 
                               FontSize="20"
                               FontWeight="SemiBold"
                               Foreground="{DynamicResource TextPrimaryColor}"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,8"/>
                    <TextBlock Text="Create your first portfolio to get started" 
                               FontSize="14"
                               Foreground="{DynamicResource TextSecondaryColor}"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,24"/>
                    <Button Content="+ Create Portfolio"
                            Style="{StaticResource PrimaryButton}"
                            Command="{Binding CreatePortfolioCommand}"
                            Height="44"
                            Padding="24,0"/>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</UserControl>